---
  - hosts: 
      - localhost
    connection: local
    vars_files:
      - ./vars.yml
    tasks:
      - name: "create VPC"
        ec2_vpc_net:
          name: "VPC-{{ PREFIX }}"
          cidr_block: "{{ VPC_ADDR }}"
          region: "{{ REGION }}"
        register: _vpc
      - name: Internet gateway
        ec2_vpc_igw:
          vpc_id: "{{ _vpc.vpc.id }}"
          region: "{{ REGION }}"
        register: _igw
      - name: "Public subnet a"
        ec2_vpc_subnet:
          vpc_id: "{{ _vpc.vpc.id }}"
          az: "{{ REGION }}a"
          cidr: "{{ SUBNET_A_ADDR }}"
          resource_tags:
            Name: "SUBNET-A-{{ PREFIX }}"
          region: "{{ REGION }}"
        register: _subnet_a
#!/bin/bash
echo "domain-name {{ DOMAIN_NAME }}" > /etc/resolv.conf
echo "nameserver 127.0.0.1" >> /etc/resolv.conf
#cp /etc/hosts /tmp/hosts
#sed -i "/{{ ansible_eth0.ipv4.address }}/d" /tmp/hosts
cat "127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4" > /tmp/hosts
{% for host in play_hosts %}
cat "{{ hostvars[host]['public_IP'] }} {{ hostvars[host]['NODENAME'] }}.{{ DOMAIN_NAME }} {{ hostvars[host]['NODENAME'] }}" >> /tmp/hosts
cat "{{ hostvars[host]['vip_IP'] }} {{ hostvars[host]['NODENAME'] }}-vip.{{ DOMAIN_NAME }} {{ hostvars[host]['NODENAME'] }}-vip" >> /tmp/hosts
{% endfor %}
cat /tmp/hosts > /etc/hosts
